{"1":"task(async () => {\n  await talk('国王', '勇者的后代')\n  await talk('国王', '这个你拿去吧')\n  await message('获得了钥匙')\n  await talk('国王', '祝你旅途愉快!')\n})\n","1001":"task(async () => {\n  await talk(\n    '国王',\n    '相传许久以前，\\n传说中的勇者洛特\\n获得神所赐予的光之珠，\\n封印了遍布世界的怪物们。'\n  )\n  await talk(\n    '国王',\n    '然而恶魔的化身龙王\\n突然不知从何处现身，\\n将那颗珠子封闭在黑暗中！'\n  )\n  await talk('国王', '再这样下去\\n世界将会被黑暗吞没，\\n最后走向毁灭。')\n  await talk(\n    '国王',\n    `勇者${heroName()}！\\n去打倒魔王，\\n将光之珠由其手中夺回吧！`\n  )\n  await talk(\n    '国王',\n    '我要送你一些礼物!\\n那边的宝箱你打开看看。\\n里面应该放有几件\\n有助你冒险的东西。'\n  )\n  await talk(\n    '国王',\n    '还有，这房间里的人，\\n了解一些旅行的知识，\\n不妨向他们请教一番。'\n  )\n  await talk('国王', `那么，再会了！\\n勇者${heroName()}！`)\n\n  finishCurrentEvent()\n})\n","1002":"task(async () => {\n  await talk('国王', '赶快去吧！ ')\n})\n","Q1":"// 国王对话\ntask(async () => {\n  if (hasQuestEvents('Q660')) {\n    await talk('king', 'Q1002_0')\n    return\n  } else if (hasQuestEvents('Q666')) {\n    await talk('king', 'Q1_2')\n    await talk('king', 'Q1_3')\n  } else {\n    await talk('king', 'Q1_0')\n  }\n  if (hero().lv < 30) {\n    await talkWithArgs({\n      characterName: 'king',\n      text: 'Q1_1',\n      textArgs: [['{nextExp}', hero().nextExp]],\n    })\n  } else {\n    await talk('king', 'Q1_4')\n  }\n})\n","Q10":"task(async (event) => {\n  showGoldWindow(true)\n  const money = event.args[0]\n  let select = await talkWithArgs({\n    characterName: '*',\n    text: 'Q10_0',\n    select: true,\n    textArgs: [['{money}', money]],\n  })\n  while (select) {\n    if (checkInventoryIsFull(4, 1)) {\n      await talk('*', 'InventoryIsFull')\n      break\n    }\n    if (money > hero().gold) {\n      await talk('*', 'NotEnoughMoney')\n      break\n    }\n    hero().gold -= money\n    addItems(4)\n    select = await talk('*', 'Q10_1', false, true)\n  }\n  await talk('*', 'Q10_2')\n  showGoldWindow(false)\n})\n","Q1051":"task(async () => {\n  const princess = getQuestNPC('PrincessQ1051')\n  princess.root.active = true\n\n  changeHeroRoleId(0)\n\n  await talk('king', 'Q1051_0')\n  await talk('king', 'Q1051_1')\n\n  await talk('luola', 'Q1051_2')\n  await talk('luola', 'Q1051_3')\n\n  await talk('luola', 'Q1051_4')\n  await talk('luola', 'Q1051_5')\n\n  await princess.smoothMoveToCoord([3, 0])\n  await princess.smoothMoveToCoord([0, -1])\n\n  addItems(505)\n\n  removeQuestEvents('Q665')\n  finishQuestEvents('Q666', 'Q1051')\n})\n","Q11":"task(async (event) => {\n  showGoldWindow(true)\n  const money = event.args[0]\n  let select = await talkWithArgs({\n    characterName: '*',\n    text: 'Q11_0',\n    select: true,\n    textArgs: [['{money}', money]],\n  })\n  while (select) {\n    if (checkInventoryIsFull(50, 1)) {\n      await talk('*', 'InventoryIsFull')\n      break\n    }\n    if (money > hero().gold) {\n      await talk('*', 'NotEnoughMoney')\n      break\n    }\n    hero().gold -= money\n    addItems(50)\n    select = await talk('*', 'Q11_1', false, true)\n  }\n  await talk('*', 'Q11_N')\n  showGoldWindow(false)\n})\n","Q1121":"task(async () => {\n  await talk('*', 'Q1121_0')\n  await talk('*', 'Q1121_1')\n  healMP()\n  flashing({ duration: 300, times: 2, color: '#38F3F5' })\n})\n","Q1122":"task(async () => {\n  await talk('*', 'Q1122_0')\n  const audios = executingEngine.audios\n  audios.pauseBGM()\n  audios.playME('se/revive.mp3')\n  healHP()\n  await delay(5000)\n  audios.pauseME()\n  audios.replayBGM()\n  await talk('*', 'Q1122_1')\n})\n","Q1500":"task(async () => {\n  const princess = getQuestNPC('PrincessQ1500')\n  const heroMove = teamController()\n  heroMove.moveSpeed = 16\n  princess.moveSpeed = 8\n\n  if (hasQuestEvents('Q665')) {\n    finishQuestEvents('Q666')\n\n    await talk('king', 'Q1500_0')\n    princess.root.active = true\n    changeHeroRoleId(0)\n  }\n\n  await talk('king', 'Q1500_1')\n  await talk('king', 'Q1500_2')\n  await talk('king', 'Q1500_3')\n  await talk('king', 'Q1500_4')\n  await talk('king', 'Q1500_5')\n  await message('Q1500_6')\n  await talk(heroName(), 'Q1500_7')\n  await talk('king', 'Q1500_8')\n  await talk('king', 'Q1500_9')\n\n  if (hasQuestEvents('Q666')) {\n    let select = false\n    await talk('luola', 'Q1500_10')\n    while (!select) {\n      await talk('luola', 'Q1500_11')\n      select = await talkWithArgs({\n        characterName: 'luola',\n        text: 'Q1500_12',\n        select: true,\n      })\n      if (!select) await talk('luola', 'Q1500_13')\n      else await talk('luola', 'Q1500_14')\n    }\n  }\n  await talk('king', 'Q1500_15')\n\n  Array(8)\n    .fill(1)\n    .map((_, i) => getQuestNPC(`bingshi_${i}`))\n    .forEach((v) => (v.roleIndex = 20))\n\n  if (hasQuestEvents('Q666')) {\n    await princess.smoothMoveToCoord([0, 1])\n  }\n\n  teamController().smoothMoveToCoord([17, 20])\n  await princess.smoothMoveToCoord([0, 6])\n  await delay(1000)\n  transitionTo('End')\n})\n","Q2":"// 出门去除标记\ntask(async () => {\n  removeQuestEvents('Q660')\n})\n","Q300":"task(async () => {\n  const npc = getQuestNPC()\n  await talk('*', 'Q300_0')\n  await talk('*', 'Q300_1')\n  await talk('*', 'Q300_2')\n  await talk('*', 'Q300_3')\n  await npc.smoothMoveToCoord([1, 0])\n  finishQuestEvents('Q300__0')\n})\n","Q301":"task(async () => {\n  await talk('*', 'Q301_0')\n})\n","Q302":"task(async () => {\n  const npc = getQuestNPC()\n  await npc.smoothMoveToCoord([-1, 0])\n  npc.moveToCoord([0, 0], 0)\n})\n","Q303":"task(async () => {\n  await talk('*', 'Q302_0')\n  await talk('*', 'Q302_1')\n  await getQuestNPC().smoothMoveToCoord([8, 0])\n})\n","Q304":"task(async () => {\n  await talk('*', 'Q304_0')\n  await talk('*', 'Q304_1')\n})\n","Q320":"task(async () => {\n  await message('Q320_0')\n  await message('Q320_1')\n  if (checkInventoryIsFull(502)) {\n    await message('InventoryIsFull')\n    return\n  }\n  addItems(502)\n  audio().pauseBGM()\n  audio().playME('se/important_item.mp3')\n  await delay(2000)\n  audio().replayBGM()\n  finishQuestEvents('Q320')\n})\n","Q330":"task(async () => {\n  await talk('*', 'Q330_0')\n  await talk('*', 'Q330_1')\n  await talk('*', 'Q330_2')\n  await talk('*', 'Q330_3')\n  await talk('*', 'Q330_4')\n  if (hasItems(502)) {\n    await talk('*', 'Q330_5')\n    await talk('*', 'Q330_6')\n    await talk('*', 'Q330_7')\n    await getQuestNPC().smoothMoveToCoord([1, 0])\n    removeItems(502)\n    finishQuestEvents('Q330')\n  }\n})\n","Q340":"task(async () => {\n  if (hasItems(506)) {\n    if (hasItems(503, 504)) {\n      await talk('*', 'Q340_4')\n      await talk('*', 'Q340_5')\n      await message('Q340_6')\n\n      const npc = getQuestNPC()\n      await npc.smoothMoveToCoord([0, -1])\n\n      await talk('*', 'Q340_7')\n\n      getGameObject('Holy').active = true\n\n      await npc.smoothMoveToCoord([0, 1])\n\n      await talk('*', 'Q340_8')\n\n      await npc.smoothMoveToCoord([1, 0])\n\n      removeItems(503, 504)\n      finishQuestEvents('Q340')\n    } else {\n      await talk('*', 'Q340_2')\n      await talk('*', 'Q340_3')\n    }\n  } else {\n    await talk('*', 'Q340_0')\n    await talk('*', 'Q340_1')\n    executingEngine.audios.playME('se/magic.mp3')\n    flashing({ duration: 400, times: 2, color: '#EEEEEE88' })\n    await delay(1000)\n    await transitionTo('World', 'HolyShrine1')\n    setInputType(InputType.Move)\n  }\n})\n","Q350":"task(async () => {\n  await message('Q350')\n\n  const coord = headCoord()\n  if (coord[0] === 69 && coord[1] === 53) {\n    globalWindow().clearWindows()\n    audio().pauseBGM()\n    audio().playME('se/rainbow.mp3')\n    await delay(6000)\n    audio().replayBGM()\n    removeItems(507)\n    finishQuestEvents('Q350')\n    setTimeout(() => {\n      setInputType(InputType.Move)\n    })\n  } else {\n    await message('NotHappenThing')\n  }\n})\n","Q4":"task(async (event) => {\n  showGoldWindow(true)\n  const money = event.args[0]\n  await talk('*', 'Q4_0')\n  const select = await talkWithArgs({\n    characterName: '*',\n    text: 'Q4_1',\n    select: true,\n    textArgs: [['{money}', money]],\n  })\n  if (!select) {\n    await talk('*', 'Q4_N')\n  } else {\n    const gold = hero().gold\n    if (gold < money) {\n      await talk('*', 'Q4_N_MONEY')\n      await talk('*', 'Q4_N')\n    } else {\n      hero().gold -= money\n      rest()\n      const audios = executingEngine.audios\n      audios.pauseBGM()\n      await fading({ type: 'in', duration: 1000 })\n      audios.playME('se/inn.mp3')\n      await delay(3000)\n      await fading({ type: 'out', duration: 1000 })\n      audios.replayBGM()\n      await talk('*', 'Q4_Y1')\n    }\n  }\n  showGoldWindow(false)\n})\n","Q5":"task(async () => {\n  const type = executingEvent.args[0]\n  const id = executingEvent.args[1]\n  await talk('*', type === 0 ? 'Q5_0' : 'Q5_1', true)\n  await shop(id)\n  await talk('*', 'Q5_N', true)\n})\n","Q50":"task(async () => {\n  await message('Q50_0')\n  await talkWithArgs({\n    characterName: 'luola',\n    text: 'Q50_1',\n    textArgs: [['{nextExp}', hero().nextExp]],\n  })\n  await talkWithArgs({\n    characterName: 'luola',\n    text: 'Q50_2',\n    textArgs: [\n      ['{coordX}', headCoord()[0]],\n      ['{coordY}', headCoord()[1]],\n    ],\n  })\n  await talk('luola', 'Q50_3')\n})\n","Q600":"task(async () => {})\n","Q610":"task(async () => {\n  await talk('luola', 'Q610_0')\n  await talk('luola', 'Q610_1')\n  await talk('luola', 'Q610_2')\n  await talk('luola', 'Q610_3')\n  await talk('luola', 'Q610_4')\n  await message('Q610_5')\n  changeHeroRoleId(1)\n  finishQuestEvents('Q665')\n})\n","Q7000":"task(async () => {\n  await talk('dragon_king', 'Q7000_0')\n  await talk('dragon_king', 'Q7000_1')\n  await talk('dragon_king', 'Q7000_2')\n\n  let select = await talkWithArgs({\n    characterName: 'dragon_king',\n    text: 'Q7000_3',\n    select: true,\n  })\n  if (!select) {\n    select = await talkWithArgs({\n      characterName: 'dragon_king',\n      text: 'Q7000_4',\n      select: true,\n    })\n  }\n  console.log(select)\n  if (select) {\n    await talk('dragon_king', 'Q7000_5')\n    await message('Q7000_6')\n    await talk('dragon_king', 'Q7000_7')\n    await talk('dragon_king', 'Q7000_8')\n    await talk('dragon_king', 'Q7000_9')\n    await talk('dragon_king', 'Q7000_10')\n    await talk('dragon_king', 'Q7000_11')\n    transitionTo('End')\n    return\n  }\n\n  await talk('dragon_king', 'Q7000_12')\n  await talk('dragon_king', 'Q7000_13')\n\n  // 战斗\n  const victory = true\n  if (victory) {\n    getQuestNPC().root.active = false\n\n    await message('Q7000_14')\n    await message('Q7000_15')\n    await flashing({ duration: 3000, times: 1, color: '#EEEEEE88' })\n    await message('Q7000_16')\n    finishQuestEvents('Q888')\n    await transitionTo('World', 'DracolordsCastle1')\n    setInputType(InputType.Move)\n  }\n})\n"}